\documentclass[a4paper,twocolumn]{jarticle}

\input{setting.tex}

\title{{\large MVCにより開発される新しいWebアプリケーションフレーム}}
\author{{\normalsize Luo GuangChun \  WngYanhua \  Lu
Xianliang \  Hanhong} \\
{\normalsize (Information Center of USET of China, ChengDu, China 610054)}}
\date{}

\headlabel{2003/10/6 須藤功平}

\begin{document}

 \maketitle

\begin{abstract}
 %Smalltalk-80で開発された
 MVC (Model/View/Controller) デザインパターンを
 用いることにより，Webアプリケーションのロジックと見た目を分離する．これ
 により，管理性，拡張性を改善する．
\end{abstract}

\section{導入}
MVCは三つのオブジェクトからなる．
\begin{description}
 \item[Model] ロジックの処理をするオブジェクト．状態が変化したらViewに通
	    知する．
 \item[View] 出力をするオブジェクト．Modelの状態を反映しなければいけない．
 \item[Controller] ユーザの入力を処理するオブジェクト．
\end{description}
ユーザインターフェイスとロジックが分離されているので，柔軟性が増し再利用
しやすくなる．例えば，子となるユーザインターフェイスを提供するために1つ
のModelに対して複数のViewを持つことが出来る．

\section{背景と問題}
\label{sec: background and solution}
ソフトウェア設計で広く使われているMVCをWebアプリケーション開発に採り入れ
るには難しい部分がある．それは，主に以下のふたつの要素のためである．

\begin{enumerate}
 \item HTMLとプログラムを分離するのが難しい
      
      以前はCGIプログラムはHTMLを出力するためにプログラム中にHTMLの断片
       を埋めこんでいた．スクリプト言語の登場によりHTML中にプログラムの
       断片を埋めこむようになった．しかし，どちらの方法でもプログラムと
       HTMLを完全に分離しているとは言えない．
 \item スクリプト言語の機能が弱い

       メッセージメカニズムやレスポンスメカニズム等のMVCデザインパターン
       をサポートするために必要な技術が欠けている．
\end{enumerate}

図\ref{fig:jsp_model_2}に示すJSP Model 2はこれを解決する．
\begin{figure}[htbp]
 \includegraphics[width=7.8cm]{../images/jsp_model_2.eps}
 \caption{JSP Model 2のWebアプリケーションシステム}
 \label{fig:jsp_model_2}
\end{figure}
\begin{description}
 \item[Model(データレイヤー)] Enterprise JavaBeanにカプセル化される．
 \item[View(プレゼンテーションレイヤー)] JSPが表示を司る．
 \item[Controller(コントロールレイヤー)] サーブレットは各ページ毎にユー
	    ザの入力を受け付け適切なトランザクションを実行する．その後，
	    JSP(View)から結果を反映する表示を受け取りユーザに返す．
\end{description}
JSP Model 2はロジックとユーザインターフェイスを分離するが，まだ近い．例
えば，サーブレットはControllerとしてModelのモジュールを起動するだけでは
なく対応するJSPの出力も返す．このため，サーブレットは複雑になり，開発と
管理性において問題を残す．よって，Webアプリケーションシステムにおける
Controllerの機能をさらに分割する．

\section{解決法}

図\ref{fig:improved frame}はこのシステムフレームが三つの核となるオブジェ
クト／クラス(SYSController, Model Center, LPM (Logical Page Module)
Center)から成り立っている．各々の核はデータベース(system description
database, model database, LPM database)を持っている．

\begin{figure}[htbp]
 \includegraphics[width=7.8cm]{../images/improved_wab_application_system_fram_based_on_mvc.eps}
 \caption{MVCに基づいたWebアプリケーションシステムフレームの改良}
 \label{fig:improved frame}
\end{figure}

\begin{description}
 \item[SYSControllerとSystem Description Database] クライアントのリクエストに
	    対して適切なトランザクションを対応付け，Messanger経由でModel
	    Centerに渡す．
 \item[Model CenterとModel Database] 受け取ったmessageに対応する処理を実
	    行するオブジェクトを選び，処理を行う．
 \item[LPM CenterとLPM Database] Model Centerからデータを受け取り，適切
	    なページを選択し，HTTPレスポンスとしてクライアントに送る．
\end{description}
SYSControllerがmessageを直接Model Centerに渡さずにMessengerを介している
のは，messageキューを利用するためである．Messengerはmessageキューに
messageを入れ，Model Centerはmessageキューを全て走査し，まだ処理されてい
ないmessageを処理するためにModelFactoryに渡す．

このバッファキューを使うとModel Centerをマルチスレッド化することにより処
理能力を改善することが出来る．あるいはModel Centerを複数のサーバに分散さ
せることも出来る．

\section{関係する問題}

\begin{description}
 \item[CGI] トランザクションだけでなく表示する部分も扱わなくてはならない．
	    これは，多大なプログラミング能力とインターフェイスデザイン能
	    力を必要とする．
 \item[ASPやPHPのようなサーバスクリプト言語] これらの言語の能力が低いた
	    めトランザクションロジックを充分にカプセル化することが出来な
	    い．
 \item[JSP Model 2] \ref{sec: background and solution}で述べた通り．
\end{description}

\section{結論}
改良されたMVCデザインパターンに基づいたWebアプリケーションシステムフレー
ムは伝統的なものよりもよい．特に，Web開発の大きな問題であるロジックとプ
レゼンテーションの分離と並列開発を実現するからだ．その上，Model Database 
とLPM Databaseを使うことにより柔軟性と管理性と拡張性が非常に改良されてい
る．このフレームを使ったWebアプリケーションシステムは中国のUESTで動いて
いる(http://www.uestc.edu.cn)．

\end{document}
